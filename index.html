<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Levered Index Synthesizer</title>
<style>
  :root { --w: 1000px; }
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; line-height: 1.35; margin: 0; color: #111; background: #fff; }
  header { padding: 16px; background: #f6f7f9; border-bottom: 1px solid #e5e7eb; }
  main { max-width: var(--w); margin: 0 auto; padding: 20px; }
  h1 { font-size: 20px; margin: 0 0 8px; }
  h2 { font-size: 16px; margin: 18px 0 10px; }
  .row { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 12px; margin: 12px 0; }
  label { font-weight: 600; display: block; margin-bottom: 6px; }
  input, select, button { width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 8px; font-size: 14px; }
  button.primary { background: #111827; color: white; border-color: #111827; cursor: pointer; }
  button.ghost { background: white; color: #111827; border-color: #111827; cursor: pointer; }
  button:disabled { opacity: 0.6; cursor: not-allowed; }
  .note { font-size: 12px; color: #475569; margin-top: 4px; }
  .grid { overflow-x: auto; border: 1px solid #e5e7eb; border-radius: 10px; }
  table { border-collapse: collapse; width: 100%; }
  th, td { border-bottom: 1px solid #f1f5f9; padding: 8px; text-align: right; white-space: nowrap; }
  th { background: #f8fafc; text-align: left; }
  .muted { color: #475569; }
  .hidden { display: none; }
  .tag { font-size: 12px; background: #eef2ff; padding: 2px 6px; border-radius: 9999px; }
  .flex { display:flex; gap:12px; flex-wrap:wrap; align-items:center; }
  .center { display:flex; align-items:center; gap:12px; }
  .info-icon { margin-left:4px; color:#6b7280; cursor:help; font-size:12px; }
  footer { max-width: var(--w); margin: 16px auto 40px; padding: 0 20px; font-size: 12px; color: #475569; }
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
</head>
<body>
  <header>
    <h1>Levered Index Synthesizer</h1>
    <div class="muted">Build a UPRO-style series from daily index returns, applying a daily fee (from annual %) + extra drag, export CSV, and view trailing stats.</div>
  </header>

  <main>
    <section>
      <div class="row">
        <div>
          <label for="dataSource">Data Source</label>
          <select id="dataSource">
            <option value="zip" selected>Zip code data</option>
            <option value="econ">Economic data</option>
          </select>
        </div>
      </div>

      <div id="zipControls">
      <div class="row">
        <div>
          <label for="etfSel">3× ETF Preset</label>
          <select id="etfSel">
            <option value="">None</option>
            <option value="UPRO" data-index="SPY" data-fee="0.91">UPRO – ProShares UltraPro S&amp;P 500</option>
            <option value="TQQQ" data-index="QQQ" data-fee="0.95">TQQQ – ProShares UltraPro QQQ</option>
            <option value="UDOW" data-index="DIA" data-fee="0.95">UDOW – ProShares UltraPro Dow30</option>
            <option value="URTY" data-index="IWM" data-fee="0.95">URTY – ProShares UltraPro Russell 2000</option>
            <option value="FAS" data-index="XLF" data-fee="0.99">FAS – Direxion Daily Financial Bull 3X</option>
          </select>
          <div class="note">Prefills index and fee for popular 3× ETFs.</div>
        </div>
        <div>
          <label for="indexSel">Index</label>
          <select id="indexSel">
            <option value="^spx" selected>S&amp;P 500 (^SPX)</option>
            <option value="^dji">Dow Jones Industrial Average (^DJI)</option>
            <option value="custom">Custom (enter symbol)</option>
          </select>
          <div class="note">For custom, use the symbol format required by Alpha Vantage.</div>
        </div>
        <div id="customWrap" class="hidden">
          <label for="customSym">Custom Symbol</label>
          <input id="customSym" placeholder="e.g., ^spx or SPX" />
          <div class="note">Match the format required by Alpha Vantage.</div>
        </div>
        <div id="apiKeyWrap">
          <label for="apiKey">API Key</label>
          <input id="apiKey" placeholder="Required for Alpha Vantage" />
          <div class="note"><a href="https://www.alphavantage.co/support/#api-key" target="_blank" rel="noopener">Get a free API key</a>.</div>
        </div>
        <div>
          <label for="levSel">Leverage</label>
          <select id="levSel">
            <option value="2">2×</option>
            <option value="3" selected>3×</option>
            <option value="4">4×</option>
            <option value="5">5×</option>
          </select>
          <div class="note">Applied to the index’s <em>daily</em> return.</div>
        </div>
        <div>
          <label for="annFee">Annual Expense Ratio</label>
          <input id="annFee" type="number" step="0.01" value="0.91" placeholder="e.g., 0.91" />
          <div class="note">Annual ratio in percent (e.g., <code>0.91</code>) converted to daily using 252 trading days.</div>
        </div>
        <div>
          <label for="drag">Extra Daily Drag</label>
          <input id="drag" type="number" step="0.00001" placeholder="e.g., 0.00005" />
          <div class="note">Optional daily extra drag, e.g., 0.00005–0.00020.</div>
        </div>
        <div>
          <label for="endDate">Metrics End Date (optional)</label>
          <input id="endDate" type="date" placeholder="YYYY-MM-DD" />
          <div class="note">Trailing windows end here; leave blank for latest date.</div>
        </div>
      </div>

      <div class="row">
        <div>
          <label for="corsProxy">CORS Proxy (optional)</label>
          <input id="corsProxy" placeholder="https://cors.isomorphic-git.org/" />
          <div class="note">Use a CORS proxy if needed; leave blank to use the default.</div>
        </div>
        <div class="center">
          <button id="runBtn" class="primary">Fetch &amp; Compute</button>
          <button id="dlBtn" class="ghost" disabled>Download CSV</button>
          <span id="status" class="muted"></span>
        </div>
      </div>
      </div><!-- end zipControls -->

      <div id="econControls" class="hidden">
        <div class="row">
          <div>
            <label for="econMonth">Month</label>
            <select id="econMonth">
              <option value="1">January</option>
              <option value="2">February</option>
              <option value="3">March</option>
              <option value="4">April</option>
              <option value="5">May</option>
              <option value="6">June</option>
              <option value="7">July</option>
              <option value="8">August</option>
              <option value="9">September</option>
              <option value="10">October</option>
              <option value="11">November</option>
              <option value="12">December</option>
            </select>
          </div>
          <div>
            <label for="econYear">Year</label>
            <select id="econYear">
              <option value="2024">2024</option>
              <option value="2023">2023</option>
              <option value="2022">2022</option>
              <option value="2021">2021</option>
              <option value="2020">2020</option>
            </select>
          </div>
          <div class="center">
            <button id="econFetch" class="primary">Fetch</button>
            <button id="econDlBtn" class="ghost" disabled>Download CSV</button>
          </div>
        </div>
      </div>
      </section>

      <section id="summarySec" class="hidden">
      <h2>Summary</h2>
      <div class="flex">
        <div class="tag" id="summaryTag"></div>
        <div class="muted" id="feeInfo"></div>
      </div>
      <p class="muted">Returns use daily closes. Synthetic series starts at value 1 on its first row.</p>
        <div class="grid">
          <table id="metricsTbl">
            <thead>
              <tr>
                <th>Window <span class="info-icon" title="Rolling window length in years">&#9432;</span></th>
                <th>Obs <span class="info-icon" title="Number of observations">&#9432;</span></th>
                <th>Avg (Index) <span class="info-icon" title="Average CAGR of the index">&#9432;</span></th>
                <th>Std Dev (Index) <span class="info-icon" title="Volatility of index CAGR">&#9432;</span></th>
                <th>Avg (Synth) <span class="info-icon" title="Average CAGR of synthetic series">&#9432;</span></th>
                <th>Std Dev (Synth) <span class="info-icon" title="Volatility of synthetic series CAGR">&#9432;</span></th>
                <th>Avg (3× ETF) <span class="info-icon" title="Average CAGR of actual 3× ETF">&#9432;</span></th>
                <th>Std Dev (3× ETF) <span class="info-icon" title="Volatility of actual 3× ETF CAGR">&#9432;</span></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="note">Source: Calculations using Alpha Vantage data.</div>
      </section>

      <section id="chartSec" class="hidden">
        <h2>Rolling CAGR</h2>
        <div class="row">
        <div>
          <label for="rollSel">Window</label>
          <select id="rollSel">
            <option value="1">1-year</option>
            <option value="3">3-year</option>
            <option value="5" selected>5-year</option>
            <option value="10">10-year</option>
            <option value="15">15-year</option>
            <option value="20">20-year</option>
            <option value="30">30-year</option>
          </select>
        </div>
      </div>
      <div class="grid">
        <canvas id="rollChart"></canvas>
      </div>
    </section>

    <section id="previewSec" class="hidden">
      <h2>Preview (last 10 rows)</h2>
      <div class="grid">
        <table id="previewTbl">
          <thead>
            <tr>
              <th style="text-align:left;">Date</th>
              <th>Index</th>
              <th>Levered Value</th>
              <th>RoR Index</th>
              <th>RoR Levered</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      </section>
      <!-- Additional data sources removed; Alpha Vantage only -->
    </main>

    <footer>
      Data from <a href="https://www.alphavantage.co/">Alpha Vantage</a>. Education/research use only.
      </footer>
<script src="script.js"></script>
<script>
const $ = sel => document.querySelector(sel);

const etfSel = $("#etfSel");
const indexSel = $("#indexSel");
const customWrap = $("#customWrap");
const customSym = $("#customSym");
const apiKey = $("#apiKey");
const levSel = $("#levSel");
const annFee = $("#annFee");
const drag = $("#drag");
const endDate = $("#endDate");
const corsProxy = $("#corsProxy");
const runBtn = $("#runBtn");
const dlBtn = $("#dlBtn");
const statusEl = $("#status");

const summarySec = $("#summarySec");
const summaryTag = $("#summaryTag");
const feeInfo = $("#feeInfo");
const metricsTBody = $("#metricsTbl tbody");

const previewSec = $("#previewSec");
const previewTBody = $("#previewTbl tbody");

const chartSec = $("#chartSec");
const rollSel = $("#rollSel");
const rollChartCanvas = $("#rollChart");

let lastCsvText = "";
let lastRows = [];
let lastActualRows = [];
let rollChart = null;

etfSel.addEventListener("change", () => {
  const opt = etfSel.selectedOptions[0];
  if (!opt || !opt.dataset.index) return;
  annFee.value = opt.dataset.fee || "";
  levSel.value = "3";
  indexSel.value = "custom";
  indexSel.dispatchEvent(new Event("change"));
  customSym.value = opt.dataset.index;
});

indexSel.addEventListener("change", () => {
  customWrap.classList.toggle("hidden", indexSel.value !== "custom");
});

rollSel.addEventListener("change", () => {
  if (!chartSec.classList.contains("hidden") && lastRows.length) {
    updateChart(Number(rollSel.value));
  }
});

async function fetchCsv(url) {
  async function get(u) {
    const res = await fetch(u);
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    return res.text();
  }
  try {
    return await get(url);
  } catch (e) {
    const userProxy = corsProxy.value.trim();
    const proxy = userProxy || "https://cors.isomorphic-git.org/";
    const proxied = proxy.endsWith("/") ? proxy + url : proxy + "/" + url;
    return await get(proxied);
  }
}

function updateChart(years) {
  const s = rollingSeries(lastRows, years);
  const labels = s.dates;
  const idxVals = s.idx.map(v => v * 100);
  const levVals = s.lev.map(v => v * 100);
  const datasets = [
    { label: "Index", data: idxVals, borderColor: "#1f77b4", tension: 0.1, spanGaps: true },
    { label: `${levSel.value}× Synth`, data: levVals, borderColor: "#d62728", tension: 0.1, spanGaps: true }
  ];
  if (lastActualRows.length) {
    const a = rollingSeriesActual(lastActualRows, years);
    const map = new Map(a.dates.map((d,i) => [d, a.act[i] * 100]));
    const actVals = labels.map(d => map.has(d) ? map.get(d) : NaN);
    datasets.push({ label: `${etfSel.value} Actual`, data: actVals, borderColor: "#2ca02c", tension: 0.1, spanGaps: true });
  }
  if (rollChart) {
    rollChart.data.labels = labels;
    rollChart.data.datasets = datasets;
    rollChart.update();
  } else {
    rollChart = new Chart(rollChartCanvas, {
      type: "line",
      data: { labels, datasets },
      options: {
        responsive: true,
        interaction: { mode: "index", intersect: false },
        scales: { y: { ticks: { callback: v => v + "%" } } },
        plugins: { tooltip: { callbacks: { label: ctx => `${ctx.dataset.label}: ${ctx.parsed.y.toFixed(2)}%` } } }
      }
    });
  }
}

function toDailyFee(annual, tradingDays = 252) {
  return 1 - Math.pow(1 - annual, 1 / tradingDays);
}

function computeSeries(data, leverage, annualExpense, extraDrag) {
  // data sorted ascending by date; each item {date, close}
  if (data.length < 2) throw new Error("Not enough data points.");
  const feeDay = toDailyFee(annualExpense, 252);

  const out = [];
  let val = 1;
  let prev = data[0].close;

  out.push({ date: data[0].date, index: data[0].close, ror_index: 0, ror_lev: 0, lev_value: val });

  for (let i = 1; i < data.length; i++) {
    const px = data[i].close;
    const r = px / prev - 1;
    const pre = leverage * r;
    const post = (1 + pre) * (1 - feeDay) - 1 - (extraDrag || 0);
    if (val <= 0 || (1 + post) <= 0) {
      val = 0;
      out.push({ date: data[i].date, index: px, ror_index: r, ror_lev: -1, lev_value: val });
    } else {
      val *= (1 + post);
      out.push({ date: data[i].date, index: px, ror_index: r, ror_lev: post, lev_value: val });
    }
    prev = px;
  }

    return { rows: out, feeDay };
  }

  function parseAlphaVantageCsv(text) {
    const trimmed = text.trim();
    if (trimmed.startsWith("{")) {
      try {
        const obj = JSON.parse(trimmed);
        const msg = obj["Error Message"] || obj["Note"] || obj["Information"] || "Unexpected response from Alpha Vantage.";
        throw new Error(msg);
      } catch (e) {
        throw new Error("Unexpected response from Alpha Vantage.");
      }
    }
    const rows = trimmed.split(/\r?\n/).map(line => line.split(","));
    const header = rows.shift();
    const idxDate = header.indexOf("timestamp");
    let idxClose = header.indexOf("adjusted_close");
    if (idxClose === -1) idxClose = header.indexOf("close");
    if (idxDate === -1 || idxClose === -1) throw new Error("Unexpected CSV columns from Alpha Vantage.");
    return rows.map(cols => ({
      date: cols[idxDate],
      close: Number(cols[idxClose])
    })).filter(r => r.date && Number.isFinite(r.close));
  }

  function symbolFor(sym) {
    const s = sym.replace(/^\^/, "").toUpperCase();
    if (s === "SPX") return "SPY";
    if (s === "DJI") return "DIA";
    return s;
  }

  function toISODate(s) { return new Date(s + "T00:00:00Z"); }

function cagr(startVal, endVal, years) {
  if (startVal <= 0 || endVal <= 0 || years <= 0) return NaN;
  return Math.pow(endVal / startVal, 1 / years) - 1;
}

function mean(arr) {
  return arr.reduce((sum, v) => sum + v, 0) / arr.length;
}

function stdDev(arr) {
  if (arr.length < 2) return 0;
  const m = mean(arr);
  let s = 0;
  for (const v of arr) s += (v - m) ** 2;
  return Math.sqrt(s / (arr.length - 1));
}

function allCagrs(rows, years) {
  const idx = [], lev = [];
  for (let i = 0; i < rows.length; i++) {
    const start = rows[i];
    const startDate = toISODate(start.date);
    const endDate = new Date(startDate);
    endDate.setUTCFullYear(endDate.getUTCFullYear() + years);
    let j = i;
    while (j < rows.length && toISODate(rows[j].date) < endDate) j++;
    if (j >= rows.length) break;
    const end = rows[j];
    const cIdx = cagr(start.index, end.index, years);
    if (Number.isFinite(cIdx)) idx.push(cIdx);
    const cLev = cagr(start.lev_value, end.lev_value, years);
    if (Number.isFinite(cLev)) lev.push(cLev);
  }
  return { idx, lev };
}

function allCagrsActual(rows, years) {
  const out = [];
  for (let i = 0; i < rows.length; i++) {
    const start = rows[i];
    const startDate = toISODate(start.date);
    const endDate = new Date(startDate);
    endDate.setUTCFullYear(endDate.getUTCFullYear() + years);
    let j = i;
    while (j < rows.length && toISODate(rows[j].date) < endDate) j++;
    if (j >= rows.length) break;
    const end = rows[j];
    const c = cagr(start.close, end.close, years);
    if (Number.isFinite(c)) out.push(c);
  }
  return out;
}

function rollingSeries(rows, years) {
  const dates = [], idx = [], lev = [];
  for (let i = 0; i < rows.length; i++) {
    const start = rows[i];
    const startDate = toISODate(start.date);
    const endDate = new Date(startDate);
    endDate.setUTCFullYear(endDate.getUTCFullYear() + years);
    let j = i;
    while (j < rows.length && toISODate(rows[j].date) < endDate) j++;
    if (j >= rows.length) break;
    const end = rows[j];
    const cIdx = cagr(start.index, end.index, years);
    const cLev = cagr(start.lev_value, end.lev_value, years);
    if (Number.isFinite(cIdx) && Number.isFinite(cLev)) {
      dates.push(start.date);
      idx.push(cIdx);
      lev.push(cLev);
    }
  }
  return { dates, idx, lev };
}

function rollingSeriesActual(rows, years) {
  const dates = [], act = [];
  for (let i = 0; i < rows.length; i++) {
    const start = rows[i];
    const startDate = toISODate(start.date);
    const endDate = new Date(startDate);
    endDate.setUTCFullYear(endDate.getUTCFullYear() + years);
    let j = i;
    while (j < rows.length && toISODate(rows[j].date) < endDate) j++;
    if (j >= rows.length) break;
    const end = rows[j];
    const c = cagr(start.close, end.close, years);
    if (Number.isFinite(c)) {
      dates.push(start.date);
      act.push(c);
    }
  }
  return { dates, act };
}

function fmtPct(x) { return Number.isFinite(x) ? (x * 100).toFixed(2) + "%" : "—"; }
function fmtNum(x) { return Number.isFinite(x) ? x.toLocaleString(undefined, { maximumFractionDigits: 6 }) : "—"; }

function buildCsv(rows) {
  const header = ["Date","index","leveraged_est_value","ror_index","ror_3x_est"];
  const lines = [header.join(",")];
  for (const r of rows) {
    lines.push([
      r.date,
      r.index,
      r.lev_value,
      r.ror_index,
      r.ror_lev
    ].join(","));
  }
  return lines.join("\n");
}

function populatePreview(rows) {
  previewTBody.innerHTML = "";
  const last = rows.slice(-10);
  for (const r of last) {
    const tr = document.createElement("tr");
    const cells = [r.date, fmtNum(r.index), fmtNum(r.lev_value), fmtNum(r.ror_index), fmtNum(r.ror_lev)];
    cells.forEach((v, i) => {
      const td = document.createElement("td");
      if (i === 0) td.style.textAlign = "left";
      td.textContent = v;
      tr.appendChild(td);
    });
    previewTBody.appendChild(tr);
  }
}

function populateMetrics(rows, feeDay, endISO) {
  summarySec.classList.remove("hidden");
  metricsTBody.innerHTML = "";

  const periods = [5, 10, 15, 20, 30];
  const endRow = endISO ? rows.find(r => r.date === endISO) : rows[rows.length - 1];
  const endDateStr = endRow.date;

  summaryTag.textContent = `End: ${endDateStr}`;
  const annPct = Number(annFee.value);
  feeInfo.textContent = `Daily fee from annual ${annPct.toFixed(2)}% ≈ ${(feeDay*100).toFixed(3)} bps/day · Leverage ${levSel.value}×`;

  for (const y of periods) {
    const { idx, lev } = allCagrs(rows, y);
    if (idx.length === 0) continue;
    const act = lastActualRows.length ? allCagrsActual(lastActualRows, y) : [];
    const tr = document.createElement("tr");
    const cells = [
      y + "y",
      idx.length,
      fmtPct(mean(idx)),
      fmtPct(stdDev(idx)),
      fmtPct(mean(lev)),
      fmtPct(stdDev(lev)),
      fmtPct(act.length ? mean(act) : NaN),
      fmtPct(act.length ? stdDev(act) : NaN)
    ];
    cells.forEach(txt => {
      const td = document.createElement("td");
      td.textContent = txt;
      tr.appendChild(td);
    });
    metricsTBody.appendChild(tr);
  }
}

dlBtn.addEventListener("click", () => {
  if (!lastCsvText) return;
  const blob = new Blob([lastCsvText], { type: "text/csv;charset=utf-8" });
  const a = document.createElement("a");
  const idxLabel = (indexSel.value === "custom" ? (customSym.value || "custom") : indexSel.value).replace("%5E","^");
  a.href = URL.createObjectURL(blob);
  a.download = `synth_${idxLabel}_${levSel.value}x.csv`;
  document.body.appendChild(a);
  a.click();
  URL.revokeObjectURL(a.href);
  a.remove();
});

runBtn.addEventListener("click", async () => {
  try {
    runBtn.disabled = true; dlBtn.disabled = true;
    summarySec.classList.add("hidden"); previewSec.classList.add("hidden"); chartSec.classList.add("hidden");
    statusEl.textContent = "Fetching…";

      let sym = indexSel.value;
      if (sym === "custom") {
        const c = customSym.value.trim();
        if (!c) throw new Error("Enter a custom symbol.");
        sym = c;
      }
      sym = symbolFor(sym);
      const key = apiKey.value.trim();
      if (!key) throw new Error("Enter API key for Alpha Vantage.");
      const url = `https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=${encodeURIComponent(sym)}&apikey=${key}&outputsize=full&datatype=csv`;
      const csv = await fetchCsv(url);
      const raw = parseAlphaVantageCsv(csv).sort((a,b) => a.date.localeCompare(b.date));
      if (raw.length < 2) throw new Error("Insufficient rows from Alpha Vantage.");

      let actualRaw = [];
      if (etfSel.value) {
        const etfSym = symbolFor(etfSel.value);
        const urlEtf = `https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=${encodeURIComponent(etfSym)}&apikey=${key}&outputsize=full&datatype=csv`;
        const csvEtf = await fetchCsv(urlEtf);
        actualRaw = parseAlphaVantageCsv(csvEtf).sort((a,b) => a.date.localeCompare(b.date));
      }

    // Clip to end date if provided
    const endStr = (endDate.value || "").trim();
    let data = raw, endISO = "";
    let actualData = actualRaw;
    if (endStr) {
      const cut = new Date(endStr + "T00:00:00Z");
      data = raw.filter(r => new Date(r.date + "T00:00:00Z") <= cut);
      if (data.length < 2) throw new Error("End date too early—no data remains.");
      endISO = data[data.length - 1].date;
      if (actualRaw.length) {
        actualData = actualRaw.filter(r => new Date(r.date + "T00:00:00Z") <= cut);
      }
    }

    const leverage = Number(levSel.value);
    const annualExpense = Number(annFee.value || 0) / 100;
    const extraDrag = Number(drag.value || 0);

    const { rows, feeDay } = computeSeries(data, leverage, annualExpense, extraDrag);

    lastRows = rows;
    lastCsvText = buildCsv(rows);
    lastActualRows = actualData;

    // UI
    previewTBody.innerHTML = "";
    populatePreview(rows);
    previewSec.classList.remove("hidden");
    populateMetrics(rows, feeDay, endISO);
    chartSec.classList.remove("hidden");
    updateChart(Number(rollSel.value));
    dlBtn.disabled = false;
    statusEl.textContent = `Done · ${rows.length.toLocaleString()} rows`;
  } catch (err) {
    console.error(err);
    statusEl.textContent = `Error: ${err.message}`;
  } finally {
    runBtn.disabled = false;
  }
});
</script>
</body>
</html>
